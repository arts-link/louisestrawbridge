{{- /* hide the menu for coming soon on the home page */}}
{{- $showMenu := true }}
{{- if site.Params.comingSoon }}
    {{- if .IsHome }}
        {{- $showMenu = false }}
    {{- end }}  
{{- end }}

{{- if $showMenu }}

<!-- Source: https://github.com/adityatelange/hugo-PaperMod/discussions/943
        Also note <ul class="menu hidden"> below -->
<button id="menu-trigger" aria-haspopup="menu" aria-label="Menu Button">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
</button>

<ul class="menu hidden">
    {{ $page := . }}
    {{- $currentPage := . }}
    
    {{ range .Site.Menus.main }}
      {{ template "menu-item" (dict "entry" . "page" $currentPage   ) }}

    {{- end }}
</ul>
{{- end }}

{{ define "menu-item" }}
  {{ $page := .page }}
  {{ with .entry }}

  {{- $menu_item_url := (cond (strings.HasSuffix .URL "/") .URL (printf "%s/" .URL) ) | absLangURL }}
  {{- $page_url:= $page.Permalink | absLangURL }}
  {{- $is_search := eq (site.GetPage .KeyName).Layout `search` }}


   
  <li>
    <a href="{{ .URL | absLangURL }}" title="{{ .Title | default .Name }} {{- cond $is_search (" (Alt + /)" | safeHTMLAttr) ("" | safeHTMLAttr ) }}"
    {{- cond $is_search (" accesskey=/" | safeHTMLAttr) ("" | safeHTMLAttr ) }}>
        <span {{- if eq $menu_item_url $page_url }} class="active" {{- end }}>
            {{- .Pre }}
            {{- .Name -}}
            {{ .Post -}}
        </span>
        {{- if (findRE "://" .URL) }}&nbsp;
        <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
            stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
            <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
            <path d="M15 3h6v6"></path>
            <path d="M10 14L21 3"></path>
        </svg>
        {{- end }}
    </a>
    {{/*  {{ if .HasChildren }}
    <ul class="sub-menu">
      {{ range .Children }}
        {{ template "menu-item" (dict "entry" . "page" $page) }}
      {{ end }}
    </ul>
    {{ end }}  */}}
</li>

      {{ end }}
{{ end }}

